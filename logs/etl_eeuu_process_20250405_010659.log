2025-04-05 01:06:59,844 - INFO - Inicio del proceso ETL - Cáncer de Mama
2025-04-05 01:06:59,865 - INFO - Iniciando extracción de datos desde Azure Data Lake
2025-04-05 01:06:59,865 - INFO - Intentando leer datos desde: https://azdletluao.dfs.core.windows.net/uao/etl/datos_EEUU/Breast_Cancer.csv
2025-04-05 01:07:00,929 - INFO - Datos cargados exitosamente. Dimensiones: (4024, 16)
2025-04-05 01:07:00,944 - INFO - Mostrando primeras filas del dataset
2025-04-05 01:07:00,958 - INFO - Iniciando Exploración de Datos (EDA)
2025-04-05 01:07:00,959 - INFO - Estructura de los datos: (4024, 16)
2025-04-05 01:07:00,962 - INFO - Tipos de datos:
Age                        int64
Race                      object
Marital Status            object
T Stage                   object
N Stage                   object
6th Stage                 object
differentiate             object
Grade                     object
A Stage                   object
Tumor Size                 int64
Estrogen Status           object
Progesterone Status       object
Regional Node Examined     int64
Reginol Node Positive      int64
Survival Months            int64
Status                    object
dtype: object
2025-04-05 01:07:00,964 - INFO - Valores faltantes:
                        Count    %
Age                         0  0.0
Race                        0  0.0
Marital Status              0  0.0
T Stage                     0  0.0
N Stage                     0  0.0
6th Stage                   0  0.0
differentiate               0  0.0
Grade                       0  0.0
A Stage                     0  0.0
Tumor Size                  0  0.0
Estrogen Status             0  0.0
Progesterone Status         0  0.0
Regional Node Examined      0  0.0
Reginol Node Positive       0  0.0
Survival Months             0  0.0
Status                      0  0.0
2025-04-05 01:07:00,985 - INFO - Estadísticas descriptivas:
                Age   Race Marital Status T Stage  N Stage 6th Stage  \
count   4024.000000   4024           4024     4024    4024      4024   
unique          NaN      3              5        4       3         5   
top             NaN  White        Married       T2      N1       IIA   
freq            NaN   3413           2643     1786    2732      1305   
mean      53.972167    NaN            NaN      NaN     NaN       NaN   
std        8.963134    NaN            NaN      NaN     NaN       NaN   
min       30.000000    NaN            NaN      NaN     NaN       NaN   
25%       47.000000    NaN            NaN      NaN     NaN       NaN   
50%       54.000000    NaN            NaN      NaN     NaN       NaN   
75%       61.000000    NaN            NaN      NaN     NaN       NaN   
max       69.000000    NaN            NaN      NaN     NaN       NaN   

                    differentiate Grade   A Stage   Tumor Size  \
count                        4024  4024      4024  4024.000000   
unique                          4     4         2          NaN   
top     Moderately differentiated     2  Regional          NaN   
freq                         2351  2351      3932          NaN   
mean                          NaN   NaN       NaN    30.473658   
std                           NaN   NaN       NaN    21.119696   
min                           NaN   NaN       NaN     1.000000   
25%                           NaN   NaN       NaN    16.000000   
50%                           NaN   NaN       NaN    25.000000   
75%                           NaN   NaN       NaN    38.000000   
max                           NaN   NaN       NaN   140.000000   

       Estrogen Status Progesterone Status  Regional Node Examined  \
count             4024                4024             4024.000000   
unique               2                   2                     NaN   
top           Positive            Positive                     NaN   
freq              3755                3326                     NaN   
mean               NaN                 NaN               14.357107   
std                NaN                 NaN                8.099675   
min                NaN                 NaN                1.000000   
25%                NaN                 NaN                9.000000   
50%                NaN                 NaN               14.000000   
75%                NaN                 NaN               19.000000   
max                NaN                 NaN               61.000000   

        Reginol Node Positive  Survival Months Status  
count             4024.000000      4024.000000   4024  
unique                    NaN              NaN      2  
top                       NaN              NaN  Alive  
freq                      NaN              NaN   3408  
mean                 4.158052        71.297962    NaN  
std                  5.109331        22.921430    NaN  
min                  1.000000         1.000000    NaN  
25%                  1.000000        56.000000    NaN  
50%                  2.000000        73.000000    NaN  
75%                  5.000000        90.000000    NaN  
max                 46.000000       107.000000    NaN  
2025-04-05 01:07:00,985 - INFO - Distribución de Status:
Status
Alive    3408
Dead      616
Name: count, dtype: int64
2025-04-05 01:07:01,382 - INFO - Histogramas generados exitosamente
2025-04-05 01:07:01,549 - INFO - Matriz de correlación generada exitosamente
2025-04-05 01:07:01,931 - INFO - Boxplots generados exitosamente
2025-04-05 01:07:01,939 - INFO - Iniciando limpieza de datos
2025-04-05 01:07:01,941 - INFO - Valores atípicos en 'Tumor Size' ajustados al percentil 95. Límite superior: 75.0
2025-04-05 01:07:01,942 - INFO - Valores únicos para Race: ['White' 'Black' 'Other']
2025-04-05 01:07:01,943 - INFO - Valores únicos para Marital Status: ['Married' 'Divorced' 'Single ' 'Widowed' 'Separated']
2025-04-05 01:07:01,944 - INFO - Valores únicos para T Stage : ['T1' 'T2' 'T3' 'T4']
2025-04-05 01:07:01,945 - INFO - Valores únicos para N Stage: ['N1' 'N2' 'N3']
2025-04-05 01:07:01,946 - INFO - Valores únicos para 6th Stage: ['IIA' 'IIIA' 'IIIC' 'IIB' 'IIIB']
2025-04-05 01:07:01,947 - INFO - Valores únicos para differentiate: ['Poorly differentiated' 'Moderately differentiated' 'Well differentiated'
 'Undifferentiated']
2025-04-05 01:07:01,947 - INFO - Valores únicos para A Stage: ['Regional' 'Distant']
2025-04-05 01:07:01,949 - INFO - Valores únicos para Estrogen Status: ['Positive' 'Negative']
2025-04-05 01:07:01,950 - INFO - Valores únicos para Progesterone Status: ['Positive' 'Negative']
2025-04-05 01:07:01,950 - INFO - Valores únicos para Status: ['Alive' 'Dead']
2025-04-05 01:07:01,953 - INFO - Número de filas duplicadas encontradas: 1
2025-04-05 01:07:01,955 - INFO - Filas duplicadas eliminadas. Nuevo tamaño del dataset: 4023
2025-04-05 01:07:01,966 - INFO - Iniciando transformación de datos
2025-04-05 01:07:01,967 - INFO - Columnas categóricas: ['Race', 'Marital Status', 'T Stage ', 'N Stage', '6th Stage', 'differentiate', 'A Stage', 'Estrogen Status', 'Progesterone Status', 'Status']
2025-04-05 01:07:01,967 - INFO - Columnas numéricas: ['Age', 'Tumor Size', 'Regional Node Examined', 'Reginol Node Positive', 'Survival Months']
2025-04-05 01:07:01,974 - INFO - No hay valores NaN restantes en el DataFrame
2025-04-05 01:07:01,975 - INFO - Iniciando codificación one-hot de variables categóricas
2025-04-05 01:07:01,987 - INFO - Codificación one-hot completada. Nuevas columnas: ['Race_Black', 'Race_Other', 'Race_White', 'Marital Status_Divorced', 'Marital Status_Married', 'Marital Status_Separated', 'Marital Status_Single ', 'Marital Status_Widowed', 'T Stage _T1', 'T Stage _T2', 'T Stage _T3', 'T Stage _T4', 'N Stage_N1', 'N Stage_N2', 'N Stage_N3', '6th Stage_IIA', '6th Stage_IIB', '6th Stage_IIIA', '6th Stage_IIIB', '6th Stage_IIIC', 'differentiate_Moderately differentiated', 'differentiate_Poorly differentiated', 'differentiate_Undifferentiated', 'differentiate_Well differentiated', 'A Stage_Distant', 'A Stage_Regional', 'Estrogen Status_Negative', 'Estrogen Status_Positive', 'Progesterone Status_Negative', 'Progesterone Status_Positive', 'Status_Alive', 'Status_Dead']
2025-04-05 01:07:01,988 - INFO - Iniciando escalado de variables numéricas
2025-04-05 01:07:01,991 - INFO - Escalado de variables numéricas completado
2025-04-05 01:07:01,992 - WARNING - DataFrame final contiene 38 valores NaN
2025-04-05 01:07:01,992 - INFO - Transformación completada. Dimensiones finales: (4024, 38)
2025-04-05 01:07:02,001 - INFO - Iniciando división de datos para entrenamiento y pruebas
2025-04-05 01:07:02,003 - INFO - Tipos de datos en columnas numéricas:
Age                       float64
Tumor Size                float64
Regional Node Examined    float64
Reginol Node Positive     float64
Survival Months           float64
dtype: object
2025-04-05 01:07:02,006 - WARNING - Se eliminaron 1 filas con valores NaN en las columnas objetivo
2025-04-05 01:07:02,014 - INFO - Dimensiones de los conjuntos:
2025-04-05 01:07:02,015 - INFO - X_train: (2816, 36), y_train: (2816, 2)
2025-04-05 01:07:02,015 - INFO - X_test: (603, 36), y_test: (603, 2)
2025-04-05 01:07:02,016 - INFO - X_val: (604, 36), y_val: (604, 2)
2025-04-05 01:07:02,018 - INFO - Distribución de clases en entrenamiento:
Status_Alive
1.0    0.846946
0.0    0.153054
Name: proportion, dtype: float64
2025-04-05 01:07:02,019 - INFO - Distribución de clases en prueba:
Status_Alive
1.0    0.84743
0.0    0.15257
Name: proportion, dtype: float64
2025-04-05 01:07:02,020 - INFO - Distribución de clases en validación:
Status_Alive
1.0    0.846026
0.0    0.153974
Name: proportion, dtype: float64
2025-04-05 01:07:02,029 - INFO - Iniciando carga de datos en Azure SQL Database
2025-04-05 01:07:02,049 - INFO - Motor de base de datos creado exitosamente
2025-04-05 01:07:03,613 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:03,697 - INFO - Tabla BreastCancer.stg_datos_eeuu eliminada si existía
2025-04-05 01:07:08,363 - INFO - DataFrame guardado en BreastCancer.stg_datos_eeuu. Tiempo: 4.59 segundos. Filas: 4024
2025-04-05 01:07:08,452 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:08,528 - INFO - Tabla BreastCancer.X_train eliminada si existía
2025-04-05 01:07:17,153 - INFO - DataFrame guardado en BreastCancer.X_train. Tiempo: 8.54 segundos. Filas: 2816
2025-04-05 01:07:17,233 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:17,315 - INFO - Tabla BreastCancer.y_train eliminada si existía
2025-04-05 01:07:21,573 - INFO - DataFrame guardado en BreastCancer.y_train. Tiempo: 4.17 segundos. Filas: 2816
2025-04-05 01:07:21,654 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:21,737 - INFO - Tabla BreastCancer.X_test eliminada si existía
2025-04-05 01:07:25,812 - INFO - DataFrame guardado en BreastCancer.X_test. Tiempo: 3.99 segundos. Filas: 603
2025-04-05 01:07:25,895 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:25,980 - INFO - Tabla BreastCancer.y_test eliminada si existía
2025-04-05 01:07:28,497 - INFO - DataFrame guardado en BreastCancer.y_test. Tiempo: 2.43 segundos. Filas: 603
2025-04-05 01:07:28,584 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:28,665 - INFO - Tabla BreastCancer.X_val eliminada si existía
2025-04-05 01:07:32,731 - INFO - DataFrame guardado en BreastCancer.X_val. Tiempo: 3.98 segundos. Filas: 604
2025-04-05 01:07:32,820 - INFO - Esquema BreastCancer verificado/creado
2025-04-05 01:07:32,901 - INFO - Tabla BreastCancer.y_val eliminada si existía
2025-04-05 01:07:35,365 - INFO - DataFrame guardado en BreastCancer.y_val. Tiempo: 2.38 segundos. Filas: 604
2025-04-05 01:07:35,366 - INFO - Todos los DataFrames se han guardado exitosamente en Azure SQL Database
2025-04-05 01:07:35,367 - INFO - Proceso ETL completado
